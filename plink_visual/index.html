<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Shing Wan CHOI">
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>4. Visualizing PRS Results - Basic Tutorial for Polygenic Risk Score Analyses</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../css/theme.css" />
  <link rel="stylesheet" href="../css/theme_extra.css" />
  <link href="../css/extra.css" rel="stylesheet" />
  <link href="../css/details.css" rel="stylesheet" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "4. Visualizing PRS Results";
    var mkdocs_page_input_path = "plink_visual.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-145068952-1', 'auto');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Basic Tutorial for Polygenic Risk Score Analyses</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../base/">1. QC of Base Data</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../target/">2. QC of Target Data</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../cal_prs/">3. Calculating and analysing PRS</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../plink/">PLINK</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../prsice/">PRSice-2</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../ldpred/">LDpred-2</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../lassosum/">lassosum</a>
                    </li>
                </ul>
                <ul class="current">
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">4. Visualizing PRS Results</a>
    <ul class="current">
    </ul>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Basic Tutorial for Polygenic Risk Score Analyses</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>4. Visualizing PRS Results</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/choishingwan/PRS-Tutorial/edit/master/docs/plink_visual.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="plotting-the-results">Plotting the Results<a class="headerlink" href="#plotting-the-results" title="Permanent link">&para;</a></h1>
<p>The PRS results corresponding to a range of P-value thresholds obtained by application of the C+T PRS method (eg. using PLINK or PRSice-2) can be visualised using <code>R</code> as follows:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We will be using <code>prs.result</code> variable, which was generated in the <a href="#finding-the-best-p-value-threshold">previous section</a></p>
</div>
<div class="tabbed-set" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><label for="__tabbed_1_1">Without ggplot2</label><div class="tabbed-content">
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #408080; font-style: italic"># We strongly recommend the use of ggplot2. Only follow this code if you</span>
<span style="color: #408080; font-style: italic"># are desperate.</span>
<span style="color: #408080; font-style: italic"># Specify that we want to generate plot in EUR.height.bar.png</span>
<span style="color: #0000FF">png</span>(<span style="color: #BA2121">&quot;EUR.height.bar.png&quot;</span>,
    height<span style="color: #666666">=10</span>, width<span style="color: #666666">=10</span>, res<span style="color: #666666">=300</span>, unit<span style="color: #666666">=</span><span style="color: #BA2121">&quot;in&quot;</span>)
<span style="color: #408080; font-style: italic"># First, obtain the colorings based on the p-value</span>
col <span style="color: #666666">&lt;-</span> <span style="color: #0000FF">suppressWarnings</span>(<span style="color: #0000FF">colorRampPalette</span>(<span style="color: #0000FF">c</span>(<span style="color: #BA2121">&quot;dodgerblue&quot;</span>, <span style="color: #BA2121">&quot;firebrick&quot;</span>)))
<span style="color: #408080; font-style: italic"># We want the color gradient to match the ranking of p-values</span>
prs.result <span style="color: #666666">&lt;-</span> prs.result[<span style="color: #0000FF">order</span>(<span style="color: #666666">-</span><span style="color: #0000FF">log10</span>(prs.result<span style="color: #666666">$</span>P)),]
prs.result<span style="color: #666666">$</span>color <span style="color: #666666">&lt;-</span>  <span style="color: #0000FF">col</span>(<span style="color: #0000FF">nrow</span>(prs.result))
prs.result <span style="color: #666666">&lt;-</span> prs.result[<span style="color: #0000FF">order</span>(prs.result<span style="color: #666666">$</span>Threshold),]
<span style="color: #408080; font-style: italic"># generate a pretty format for p-value output</span>
prs.result<span style="color: #666666">$</span>print.p <span style="color: #666666">&lt;-</span> <span style="color: #0000FF">round</span>(prs.result<span style="color: #666666">$</span>P, digits <span style="color: #666666">=</span> <span style="color: #666666">3</span>)
prs.result<span style="color: #666666">$</span>print.p[<span style="color: #666666">!</span><span style="color: #0000FF">is.na</span>(prs.result<span style="color: #666666">$</span>print.p) <span style="color: #666666">&amp;</span> prs.result<span style="color: #666666">$</span>print.p <span style="color: #666666">==</span> <span style="color: #666666">0</span> ] <span style="color: #666666">&lt;-</span>
    <span style="color: #0000FF">format</span>(prs.result<span style="color: #666666">$</span>P[<span style="color: #666666">!</span><span style="color: #0000FF">is.na</span>(prs.result<span style="color: #666666">$</span>print.p) <span style="color: #666666">&amp;</span> prs.result<span style="color: #666666">$</span>print.p <span style="color: #666666">==</span> <span style="color: #666666">0</span> ], digits <span style="color: #666666">=</span> <span style="color: #666666">2</span>)
prs.result<span style="color: #666666">$</span>print.p <span style="color: #666666">&lt;-</span> <span style="color: #0000FF">sub</span>(<span style="color: #BA2121">&quot;e&quot;</span>, <span style="color: #BA2121">&quot;*x*10^&quot;</span>, prs.result<span style="color: #666666">$</span>print.p)
<span style="color: #408080; font-style: italic"># Generate the axis labels</span>
xlab <span style="color: #666666">&lt;-</span> <span style="color: #0000FF">expression</span>(<span style="color: #0000FF">italic</span>(P) <span style="color: #666666">-</span> value <span style="color: #666666">~</span> threshold <span style="color: #666666">~</span> (<span style="color: #0000FF">italic</span>(P)[<span style="color: #008000">T</span>]))
ylab <span style="color: #666666">&lt;-</span> <span style="color: #0000FF">expression</span>(<span style="color: #0000FF">paste</span>(<span style="color: #BA2121">&quot;PRS model fit:  &quot;</span>, R <span style="color: #666666">^</span> <span style="color: #666666">2</span>))
<span style="color: #408080; font-style: italic"># Setup the drawing area</span>
<span style="color: #0000FF">layout</span>(<span style="color: #0000FF">t</span>(<span style="color: #666666">1:2</span>), widths<span style="color: #666666">=</span><span style="color: #0000FF">c</span>(<span style="color: #666666">8.8</span>,<span style="color: #666666">1.2</span>))
<span style="color: #0000FF">par</span>( cex.lab<span style="color: #666666">=1.5</span>, cex.axis<span style="color: #666666">=1.25</span>, font.lab<span style="color: #666666">=2</span>, 
    oma<span style="color: #666666">=</span><span style="color: #0000FF">c</span>(<span style="color: #666666">0</span>,<span style="color: #666666">0.5</span>,<span style="color: #666666">0</span>,<span style="color: #666666">0</span>),
    mar<span style="color: #666666">=</span><span style="color: #0000FF">c</span>(<span style="color: #666666">4</span>,<span style="color: #666666">6</span>,<span style="color: #666666">0.5</span>,<span style="color: #666666">0.5</span>))
<span style="color: #408080; font-style: italic"># Plotting the bars</span>
b<span style="color: #666666">&lt;-</span> <span style="color: #0000FF">barplot</span>(height<span style="color: #666666">=</span>prs.result<span style="color: #666666">$</span>R2, 
            col<span style="color: #666666">=</span>prs.result<span style="color: #666666">$</span>color, 
            border<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">NA</span>, 
            ylim<span style="color: #666666">=</span><span style="color: #0000FF">c</span>(<span style="color: #666666">0</span>, <span style="color: #0000FF">max</span>(prs.result<span style="color: #666666">$</span>R2)<span style="color: #666666">*1.25</span>), 
            axes <span style="color: #666666">=</span> <span style="color: #008000">F</span>, ann<span style="color: #666666">=</span><span style="color: #008000">F</span>)
<span style="color: #408080; font-style: italic"># Plot the axis labels and axis ticks</span>
odd <span style="color: #666666">&lt;-</span> <span style="color: #0000FF">seq</span>(<span style="color: #666666">0</span>,<span style="color: #0000FF">nrow</span>(prs.result)<span style="color: #666666">+1</span>,<span style="color: #666666">2</span>)
even <span style="color: #666666">&lt;-</span> <span style="color: #0000FF">seq</span>(<span style="color: #666666">1</span>,<span style="color: #0000FF">nrow</span>(prs.result),<span style="color: #666666">2</span>)
<span style="color: #0000FF">axis</span>(side<span style="color: #666666">=1</span>, at<span style="color: #666666">=</span>b[odd], labels<span style="color: #666666">=</span>prs.result<span style="color: #666666">$</span>Threshold[odd], lwd<span style="color: #666666">=2</span>)
<span style="color: #0000FF">axis</span>(side<span style="color: #666666">=1</span>, at<span style="color: #666666">=</span>b[even], labels<span style="color: #666666">=</span>prs.result<span style="color: #666666">$</span>Threshold[even],lwd<span style="color: #666666">=2</span>)
<span style="color: #0000FF">axis</span>(side<span style="color: #666666">=1</span>, at<span style="color: #666666">=</span><span style="color: #0000FF">c</span>(<span style="color: #666666">0</span>,b[<span style="color: #666666">1</span>],<span style="color: #666666">2*</span>b[<span style="color: #0000FF">length</span>(b)]<span style="color: #666666">-</span>b[<span style="color: #0000FF">length</span>(b)<span style="color: #666666">-1</span>]), labels<span style="color: #666666">=</span><span style="color: #0000FF">c</span>(<span style="color: #BA2121">&quot;&quot;</span>,<span style="color: #BA2121">&quot;&quot;</span>,<span style="color: #BA2121">&quot;&quot;</span>), lwd<span style="color: #666666">=2</span>, lwd.tick<span style="color: #666666">=0</span>)
<span style="color: #408080; font-style: italic"># Write the p-value on top of each bar</span>
<span style="color: #0000FF">text</span>( <span style="color: #0000FF">parse</span>(text<span style="color: #666666">=</span><span style="color: #0000FF">paste</span>(
    prs.result<span style="color: #666666">$</span>print.p)), 
    x <span style="color: #666666">=</span> b<span style="color: #666666">+0.1</span>, 
    y <span style="color: #666666">=</span>  prs.result<span style="color: #666666">$</span>R2<span style="color: #666666">+</span> (<span style="color: #0000FF">max</span>(prs.result<span style="color: #666666">$</span>R2)<span style="color: #666666">*1.05-</span><span style="color: #0000FF">max</span>(prs.result<span style="color: #666666">$</span>R2)), 
    srt <span style="color: #666666">=</span> <span style="color: #666666">45</span>)
<span style="color: #408080; font-style: italic"># Now plot the axis lines</span>
<span style="color: #0000FF">box</span>(bty<span style="color: #666666">=</span><span style="color: #BA2121">&#39;L&#39;</span>, lwd<span style="color: #666666">=2</span>)
<span style="color: #0000FF">axis</span>(<span style="color: #666666">2</span>,las<span style="color: #666666">=2</span>, lwd<span style="color: #666666">=2</span>)
<span style="color: #408080; font-style: italic"># Plot the axis titles</span>
<span style="color: #0000FF">title</span>(ylab<span style="color: #666666">=</span>ylab, line<span style="color: #666666">=4</span>, cex.lab<span style="color: #666666">=1.5</span>, font<span style="color: #666666">=2</span> )
<span style="color: #0000FF">title</span>(xlab<span style="color: #666666">=</span>xlab, line<span style="color: #666666">=2.5</span>, cex.lab<span style="color: #666666">=1.5</span>, font<span style="color: #666666">=2</span> )
<span style="color: #408080; font-style: italic"># Generate plot area for the legend</span>
<span style="color: #0000FF">par</span>(cex.lab<span style="color: #666666">=1.5</span>, cex.axis<span style="color: #666666">=1.25</span>, font.lab<span style="color: #666666">=2</span>, 
    mar<span style="color: #666666">=</span><span style="color: #0000FF">c</span>(<span style="color: #666666">20</span>,<span style="color: #666666">0</span>,<span style="color: #666666">20</span>,<span style="color: #666666">4</span>))
prs.result <span style="color: #666666">&lt;-</span> prs.result[<span style="color: #0000FF">order</span>(<span style="color: #666666">-</span><span style="color: #0000FF">log10</span>(prs.result<span style="color: #666666">$</span>P)),]
<span style="color: #0000FF">image</span>(<span style="color: #666666">1</span>, <span style="color: #666666">-</span><span style="color: #0000FF">log10</span>(prs.result<span style="color: #666666">$</span>P), <span style="color: #0000FF">t</span>(<span style="color: #0000FF">seq_along</span>(<span style="color: #666666">-</span><span style="color: #0000FF">log10</span>(prs.result<span style="color: #666666">$</span>P))), col<span style="color: #666666">=</span>prs.result<span style="color: #666666">$</span>color, axes<span style="color: #666666">=</span><span style="color: #008000">F</span>,ann<span style="color: #666666">=</span><span style="color: #008000">F</span>)
<span style="color: #0000FF">axis</span>(<span style="color: #666666">4</span>,las<span style="color: #666666">=2</span>,xaxs<span style="color: #666666">=</span><span style="color: #BA2121">&#39;r&#39;</span>,yaxs<span style="color: #666666">=</span><span style="color: #BA2121">&#39;r&#39;</span>, tck<span style="color: #666666">=0.2</span>, col<span style="color: #666666">=</span><span style="color: #BA2121">&quot;white&quot;</span>)
<span style="color: #408080; font-style: italic"># plot legend title</span>
<span style="color: #0000FF">title</span>(<span style="color: #0000FF">bquote</span>(<span style="color: #0000FF">atop</span>(<span style="color: #666666">-</span>log[<span style="color: #666666">10</span>] <span style="color: #666666">~</span> model, <span style="color: #0000FF">italic</span>(P) <span style="color: #666666">-</span> value), ), 
        line<span style="color: #666666">=2</span>, cex<span style="color: #666666">=1.5</span>, font<span style="color: #666666">=2</span>, adj<span style="color: #666666">=0</span>)
<span style="color: #408080; font-style: italic"># write the plot to file</span>
<span style="color: #0000FF">dev.off</span>()
<span style="color: #0000FF">q</span>() <span style="color: #408080; font-style: italic"># exit R</span>
</code></pre></div>
</div>
<input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><label for="__tabbed_1_2">ggplot2</label><div class="tabbed-content">
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #408080; font-style: italic"># ggplot2 is a handy package for plotting</span>
<span style="color: #0000FF">library</span>(ggplot2)
<span style="color: #408080; font-style: italic"># generate a pretty format for p-value output</span>
prs.result<span style="color: #666666">$</span>print.p <span style="color: #666666">&lt;-</span> <span style="color: #0000FF">round</span>(prs.result<span style="color: #666666">$</span>P, digits <span style="color: #666666">=</span> <span style="color: #666666">3</span>)
prs.result<span style="color: #666666">$</span>print.p[<span style="color: #666666">!</span><span style="color: #0000FF">is.na</span>(prs.result<span style="color: #666666">$</span>print.p) <span style="color: #666666">&amp;</span>
                    prs.result<span style="color: #666666">$</span>print.p <span style="color: #666666">==</span> <span style="color: #666666">0</span>] <span style="color: #666666">&lt;-</span>
    <span style="color: #0000FF">format</span>(prs.result<span style="color: #666666">$</span>P[<span style="color: #666666">!</span><span style="color: #0000FF">is.na</span>(prs.result<span style="color: #666666">$</span>print.p) <span style="color: #666666">&amp;</span>
                            prs.result<span style="color: #666666">$</span>print.p <span style="color: #666666">==</span> <span style="color: #666666">0</span>], digits <span style="color: #666666">=</span> <span style="color: #666666">2</span>)
prs.result<span style="color: #666666">$</span>print.p <span style="color: #666666">&lt;-</span> <span style="color: #0000FF">sub</span>(<span style="color: #BA2121">&quot;e&quot;</span>, <span style="color: #BA2121">&quot;*x*10^&quot;</span>, prs.result<span style="color: #666666">$</span>print.p)
<span style="color: #408080; font-style: italic"># Initialize ggplot, requiring the threshold as the x-axis (use factor so that it is uniformly distributed)</span>
<span style="color: #0000FF">ggplot</span>(data <span style="color: #666666">=</span> prs.result, <span style="color: #0000FF">aes</span>(x <span style="color: #666666">=</span> <span style="color: #0000FF">factor</span>(Threshold), y <span style="color: #666666">=</span> R2)) <span style="color: #666666">+</span>
    <span style="color: #408080; font-style: italic"># Specify that we want to print p-value on top of the bars</span>
    <span style="color: #0000FF">geom_text</span>(
        <span style="color: #0000FF">aes</span>(label <span style="color: #666666">=</span> <span style="color: #0000FF">paste</span>(print.p)),
        vjust <span style="color: #666666">=</span> <span style="color: #666666">-1.5</span>,
        hjust <span style="color: #666666">=</span> <span style="color: #666666">0</span>,
        angle <span style="color: #666666">=</span> <span style="color: #666666">45</span>,
        cex <span style="color: #666666">=</span> <span style="color: #666666">4</span>,
        parse <span style="color: #666666">=</span> <span style="color: #008000">T</span>
    )  <span style="color: #666666">+</span>
    <span style="color: #408080; font-style: italic"># Specify the range of the plot, *1.25 to provide enough space for the p-values</span>
    <span style="color: #0000FF">scale_y_continuous</span>(limits <span style="color: #666666">=</span> <span style="color: #0000FF">c</span>(<span style="color: #666666">0</span>, <span style="color: #0000FF">max</span>(prs.result<span style="color: #666666">$</span>R2) <span style="color: #666666">*</span> <span style="color: #666666">1.25</span>)) <span style="color: #666666">+</span>
    <span style="color: #408080; font-style: italic"># Specify the axis labels</span>
    <span style="color: #0000FF">xlab</span>(<span style="color: #0000FF">expression</span>(<span style="color: #0000FF">italic</span>(P) <span style="color: #666666">-</span> value <span style="color: #666666">~</span> threshold <span style="color: #666666">~</span> (<span style="color: #0000FF">italic</span>(P)[<span style="color: #008000">T</span>]))) <span style="color: #666666">+</span>
    <span style="color: #0000FF">ylab</span>(<span style="color: #0000FF">expression</span>(<span style="color: #0000FF">paste</span>(<span style="color: #BA2121">&quot;PRS model fit:  &quot;</span>, R <span style="color: #666666">^</span> <span style="color: #666666">2</span>))) <span style="color: #666666">+</span>
    <span style="color: #408080; font-style: italic"># Draw a bar plot</span>
    <span style="color: #0000FF">geom_bar</span>(<span style="color: #0000FF">aes</span>(fill <span style="color: #666666">=</span> <span style="color: #666666">-</span><span style="color: #0000FF">log10</span>(P)), stat <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;identity&quot;</span>) <span style="color: #666666">+</span>
    <span style="color: #408080; font-style: italic"># Specify the colors</span>
    <span style="color: #0000FF">scale_fill_gradient2</span>(
        low <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;dodgerblue&quot;</span>,
        high <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;firebrick&quot;</span>,
        mid <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;dodgerblue&quot;</span>,
        midpoint <span style="color: #666666">=</span> <span style="color: #666666">1e-4</span>,
        name <span style="color: #666666">=</span> <span style="color: #0000FF">bquote</span>(<span style="color: #0000FF">atop</span>(<span style="color: #666666">-</span>log[<span style="color: #666666">10</span>] <span style="color: #666666">~</span> model, <span style="color: #0000FF">italic</span>(P) <span style="color: #666666">-</span> value),)
    ) <span style="color: #666666">+</span>
    <span style="color: #408080; font-style: italic"># Some beautification of the plot</span>
    <span style="color: #0000FF">theme_classic</span>() <span style="color: #666666">+</span> <span style="color: #0000FF">theme</span>(
        axis.title <span style="color: #666666">=</span> <span style="color: #0000FF">element_text</span>(face <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;bold&quot;</span>, size <span style="color: #666666">=</span> <span style="color: #666666">18</span>),
        axis.text <span style="color: #666666">=</span> <span style="color: #0000FF">element_text</span>(size <span style="color: #666666">=</span> <span style="color: #666666">14</span>),
        legend.title <span style="color: #666666">=</span> <span style="color: #0000FF">element_text</span>(face <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;bold&quot;</span>, size <span style="color: #666666">=</span>
                                        <span style="color: #666666">18</span>),
        legend.text <span style="color: #666666">=</span> <span style="color: #0000FF">element_text</span>(size <span style="color: #666666">=</span> <span style="color: #666666">14</span>),
        axis.text.x <span style="color: #666666">=</span> <span style="color: #0000FF">element_text</span>(angle <span style="color: #666666">=</span> <span style="color: #666666">45</span>, hjust <span style="color: #666666">=</span>
                                    <span style="color: #666666">1</span>)
    )
<span style="color: #408080; font-style: italic"># save the plot</span>
<span style="color: #0000FF">ggsave</span>(<span style="color: #BA2121">&quot;EUR.height.bar.png&quot;</span>, height <span style="color: #666666">=</span> <span style="color: #666666">7</span>, width <span style="color: #666666">=</span> <span style="color: #666666">7</span>)
<span style="color: #0000FF">q</span>() <span style="color: #408080; font-style: italic"># exit R</span>
</code></pre></div>
</div>
</div>
<p><img alt="Example Bar Plot" src="../img/EUR.height.bar.png" /></p>
<blockquote>
<p>An example bar plot generated using <code>ggplot2</code></p>
</blockquote>
<p>In addition, we can visualise the relationship between the "best-fit" PRS (which may have been obtained from any of the PRS programs) and the phenotype of interest, coloured according to sex:</p>
<div class="tabbed-set" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><label for="__tabbed_2_1">Without ggplot2</label><div class="tabbed-content">
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #408080; font-style: italic"># Read in the files</span>
prs <span style="color: #666666">&lt;-</span> <span style="color: #0000FF">read.table</span>(<span style="color: #BA2121">&quot;EUR.0.3.profile&quot;</span>, header<span style="color: #666666">=</span><span style="color: #008000">T</span>)
height <span style="color: #666666">&lt;-</span> <span style="color: #0000FF">read.table</span>(<span style="color: #BA2121">&quot;EUR.height&quot;</span>, header<span style="color: #666666">=</span><span style="color: #008000">T</span>)
sex <span style="color: #666666">&lt;-</span> <span style="color: #0000FF">read.table</span>(<span style="color: #BA2121">&quot;EUR.cov&quot;</span>, header<span style="color: #666666">=</span><span style="color: #008000">T</span>)
<span style="color: #408080; font-style: italic"># Rename the sex</span>
sex<span style="color: #666666">$</span>Sex <span style="color: #666666">&lt;-</span> <span style="color: #0000FF">as.factor</span>(sex<span style="color: #666666">$</span>Sex)
<span style="color: #0000FF">levels</span>(sex<span style="color: #666666">$</span>Sex) <span style="color: #666666">&lt;-</span> <span style="color: #0000FF">c</span>(<span style="color: #BA2121">&quot;Male&quot;</span>, <span style="color: #BA2121">&quot;Female&quot;</span>)
<span style="color: #408080; font-style: italic"># Merge the files</span>
dat <span style="color: #666666">&lt;-</span> <span style="color: #0000FF">merge</span>(<span style="color: #0000FF">merge</span>(prs, height), sex)
<span style="color: #408080; font-style: italic"># Start plotting</span>
<span style="color: #0000FF">plot</span>(x<span style="color: #666666">=</span>dat<span style="color: #666666">$</span>SCORE, y<span style="color: #666666">=</span>dat<span style="color: #666666">$</span>Height, col<span style="color: #666666">=</span><span style="color: #BA2121">&quot;white&quot;</span>,
    xlab<span style="color: #666666">=</span><span style="color: #BA2121">&quot;Polygenic Score&quot;</span>, ylab<span style="color: #666666">=</span><span style="color: #BA2121">&quot;Height&quot;</span>)
<span style="color: #0000FF">with</span>(<span style="color: #0000FF">subset</span>(dat, Sex<span style="color: #666666">==</span><span style="color: #BA2121">&quot;Male&quot;</span>), <span style="color: #0000FF">points</span>(x<span style="color: #666666">=</span>SCORE, y<span style="color: #666666">=</span>Height, col<span style="color: #666666">=</span><span style="color: #BA2121">&quot;red&quot;</span>))
<span style="color: #0000FF">with</span>(<span style="color: #0000FF">subset</span>(dat, Sex<span style="color: #666666">==</span><span style="color: #BA2121">&quot;Female&quot;</span>), <span style="color: #0000FF">points</span>(x<span style="color: #666666">=</span>SCORE, y<span style="color: #666666">=</span>Height, col<span style="color: #666666">=</span><span style="color: #BA2121">&quot;blue&quot;</span>))
<span style="color: #0000FF">q</span>() <span style="color: #408080; font-style: italic"># exit R</span>
</code></pre></div>
</div>
<input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><label for="__tabbed_2_2">ggplot2</label><div class="tabbed-content">
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><code><span style="color: #0000FF">library</span>(ggplot2)
<span style="color: #408080; font-style: italic"># Read in the files</span>
prs <span style="color: #666666">&lt;-</span> <span style="color: #0000FF">read.table</span>(<span style="color: #BA2121">&quot;EUR.0.3.profile&quot;</span>, header<span style="color: #666666">=</span><span style="color: #008000">T</span>)
height <span style="color: #666666">&lt;-</span> <span style="color: #0000FF">read.table</span>(<span style="color: #BA2121">&quot;EUR.height&quot;</span>, header<span style="color: #666666">=</span><span style="color: #008000">T</span>)
sex <span style="color: #666666">&lt;-</span> <span style="color: #0000FF">read.table</span>(<span style="color: #BA2121">&quot;EUR.cov&quot;</span>, header<span style="color: #666666">=</span><span style="color: #008000">T</span>)
<span style="color: #408080; font-style: italic"># Rename the sex</span>
sex<span style="color: #666666">$</span>Sex <span style="color: #666666">&lt;-</span> <span style="color: #0000FF">as.factor</span>(sex<span style="color: #666666">$</span>Sex)
<span style="color: #0000FF">levels</span>(sex<span style="color: #666666">$</span>Sex) <span style="color: #666666">&lt;-</span> <span style="color: #0000FF">c</span>(<span style="color: #BA2121">&quot;Male&quot;</span>, <span style="color: #BA2121">&quot;Female&quot;</span>)
<span style="color: #408080; font-style: italic"># Merge the files</span>
dat <span style="color: #666666">&lt;-</span> <span style="color: #0000FF">merge</span>(<span style="color: #0000FF">merge</span>(prs, height), sex)
<span style="color: #408080; font-style: italic"># Start plotting</span>
<span style="color: #0000FF">ggplot</span>(dat, <span style="color: #0000FF">aes</span>(x<span style="color: #666666">=</span>SCORE, y<span style="color: #666666">=</span>Height, color<span style="color: #666666">=</span>Sex))<span style="color: #666666">+</span>
    <span style="color: #0000FF">geom_point</span>()<span style="color: #666666">+</span>
    <span style="color: #0000FF">theme_classic</span>()<span style="color: #666666">+</span>
    <span style="color: #0000FF">labs</span>(x<span style="color: #666666">=</span><span style="color: #BA2121">&quot;Polygenic Score&quot;</span>, y<span style="color: #666666">=</span><span style="color: #BA2121">&quot;Height&quot;</span>)
<span style="color: #0000FF">q</span>() <span style="color: #408080; font-style: italic"># exit R</span>
</code></pre></div>
</div>
</div>
<p><img alt="Example Scatter Plot" src="../img/EUR.height.scatter.png" /></p>
<blockquote>
<p>An example scatter plot generated using <code>ggplot2</code></p>
</blockquote>
<p>Programs such as PRSice-2 and <a href="https://privefl.github.io/bigsnpr/">bigsnpr</a> include numerous options for plotting PRS results.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../lassosum/" class="btn btn-neutral" title="lassosum"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/choishingwan/PRS-Tutorial/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../lassosum/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
      <script src="../javascripts/details.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
